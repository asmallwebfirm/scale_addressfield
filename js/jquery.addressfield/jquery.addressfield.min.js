/*! Address Field - v0.2.1 - 2014-09-26
* https://github.com/tableau-mkt/jquery.addressfield
* Copyright (c) 2014 Eric Peterson; Licensed GPL-2.0 */
!function(a){a.fn.addressfield=function(b,c){var d,e,f=a(this),g=[];for(e in b)if("object"==typeof b[e]){if(d=f.find("."+e),!b[e].hasOwnProperty("label"))return a.fn.addressfield.call(d,b[e],c);d.length&&-1!==a.inArray(e,c)&&(g.push(e),"undefined"!=typeof b[e].options?(d.is("select")||(d=a.fn.addressfield.convertToSelect.call(d)),a.fn.addressfield.updateOptions.call(d,b[e].options)):d.is("select")&&(d=a.fn.addressfield.convertToText.call(d)),a.fn.addressfield.updateLabel.call(d,b[e].label)),a.fn.addressfield.isVisible.call(d)||-1===a.inArray(e,c)||a.fn.addressfield.showField.call(d)}return a.each(c,function(c,d){var e=f.find("."+d);e.length&&!b.hasOwnProperty(d)&&a.fn.addressfield.hideField.call(e)}),a.fn.addressfield.orderFields.call(f,g),this},a.fn.addressfield.updateLabel=function(b){var c=a(this),d=c.attr("id"),e=a('label[for="'+d+'"]')||c.prev("label");e.text(b)},a.fn.addressfield.updateOptions=function(b){var c=a(this),d=c.data("_saved")||c.val();c.children("option").remove(),a.each(b,function(b,d){c.append(a("<option></option>").attr("value",b).text(d))}),c.val(d).change(),c.removeData("_saved")},a.fn.addressfield.convertToText=function(){var b=a(this),c=a("<input />").attr("type","text");return a.fn.addressfield.copyAttrsTo.call(b,c),c.val(b.val()),b.replaceWith(c),c},a.fn.addressfield.convertToSelect=function(){var b=a(this),c=a("<select></select>");return a.fn.addressfield.copyAttrsTo.call(b,c),c.data("_saved",b.val()),b.replaceWith(c),c},a.fn.addressfield.hideField=function(){a(this).val("").hide(),a.fn.addressfield.container.call(this).hide()},a.fn.addressfield.showField=function(){this.show(),a.fn.addressfield.container.call(this).show()},a.fn.addressfield.isVisible=function(){return a(this).is(":visible")},a.fn.addressfield.container=function(){var b=a(this),c=b.attr("id"),d=a('label[for="'+c+'"]')||b.prev("label");return"function"==typeof a.fn.has?b.parents().has(d).first():b.parents().find(":has(label):has(#"+c+"):last")},a.fn.addressfield.copyAttrsTo=function(b){var c=["class","id","name","propdescname"],d=a(this);a.each(d[0].attributes,function(){-1!==a.inArray(this.name,c)&&("propdescname"===this.name?b.attr("name",this.value):b.attr(this.name,this.value))})},a.fn.addressfield.orderFields=function(b){var c,d=b.length,e=0;for(e;d>e;++e)e in b&&(c=a.fn.addressfield.container.call(this.find("."+b[e])),b[e]={element:c.clone(),"class":b[e],value:a(this).find("."+b[e]).val()},c.remove());for(e=0;d>e;++e)e in b&&(c=a(this).append(b[e].element),c.find("."+b[e]["class"]).val(b[e].value).change())}}(jQuery);